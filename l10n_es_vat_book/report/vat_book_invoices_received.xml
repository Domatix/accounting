<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>
<template id="report_vat_book_invoices_received_document">
    <t t-call="report.html_container">

        <div class="page">
            <style type="text/css">
               .detail_table {
                   width:100%;
                   margin-top: 2%;
               }
               .td_detail_table{
                  width: 50%;
                  padding-right: 5%;
               }
           </style>
            <div class="row">

              <div class="col-xs-12 text-center" id="title">
                  <h3>Vat Book invoices received</h3>
              </div>

              <div class="col-xs-6" id="fiscal_periods_div" style="float: left">
                <table class="detail_table" id="fiscal_periods_table">
                  <tbody class="invoice_tbody">
                    <tr>
                      <td class="text-right td_detail_table">
                        <strong>Company:</strong>
                      </td>
                      <td class="td_detail_table">
                        <span t-field="o.company_id"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-right td_detail_table">
                        <strong>Fiscal Year:</strong>
                      </td>
                      <td class="td_detail_table">
                        <span t-field="o.fiscalyear_id"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-right td_detail_table">
                        <strong>Periods:</strong>
                      </td>
                      <td class="td_detail_table">
                        <t t-foreach="o.periods" t-as="period">
                          <span t-field="period.name"/>
                        </t>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <div class="col-xs-6" id="vat_book_contact_div" style="float: right">
                <table class="detail_table" id="vat_book_contact_table">
                  <tbody class="invoice_tbody">
                    <tr>
                      <td class="text-right td_detail_table">
                        <strong>VAT:</strong>
                      </td>
                      <td class="td_detail_table">
                        <span t-field="o.company_vat"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-right td_detail_table">
                        <strong>Contact phone:</strong>
                      </td>
                      <td class="td_detail_table">
                        <span t-field="o.contact_phone"/>
                      </td>
                    </tr>
                    <tr>
                      <td class="text-right td_detail_table">
                        <strong>Surnames and name contact:</strong>
                      </td>
                      <td class="td_detail_table">
                        <span t-field="o.contact_name"/>
                      </td>
                    </tr>
                    <tr>
                    <td class="text-right td_detail_table">
                      <strong>Calculation Date:</strong>
                    </td>
                    <td class="td_detail_table">
                      <span t-field="o.calculation_date"/>
                    </td>
                  </tr>
                  </tbody>
                </table>
              </div>
              <br/>
              <br/>

              <div class="col-xs-12" id="detail_div" style="margin-top: 10px">
                <table class="table table-condensed" id="detail_table">
                    <thead>
                        <tr>
                          <th  id="detail_invoice_date" style="text-align: center; vertical-align: middle" ><strong>Invoice date</strong></th>
                            <th  id="detail_odoo_invoice" style="text-align: center; vertical-align: middle"><strong>Invoice number</strong></th>
                            <th  id="detail_invoice_number" style="vertical-align: middle"><strong>Supplier Invoice</strong></th>
                            <th  id="detail_company" style="vertical-align: middle"><strong>Company</strong></th>
                            <th  id="detail_vat" style="text-align: center; vertical-align: middle"><strong>VAT</strong></th>
                            <td id="detail_code" style="vertical-align: middle"><strong>Code</strong></td>
                            <th  id="detail_base" style="text-align: center; vertical-align: middle"><strong>Base</strong></th>
                            <th  id="detail_type" style="text-align: center; vertical-align: middle"><strong>Type</strong></th>
                            <th  id="detail_cuote" style="text-align: center; vertical-align: middle"><strong>Cuote</strong></th>
                            <th  style="text-align: center; vertical-align: middle"><strong>Total</strong></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr t-foreach="o.received_invoice_ids" t-as="l">
                          <td id="data_invoice_date" style="text-align: center">
                            <span t-esc="formatLang(l.invoice_id.date_invoice,date=True)"/>
                          </td>
                            <td id="data_odoo_invoice" style="text-align: center">
                              <span t-field="l.invoice_id.number"/>
                            </td>
                            <td id="data_invoice_number">
                              <span t-esc="l.invoice_id.reference or l.invoice_id.number or ''"/>
                            </td>
                            <td id="data_company">
                              <span t-field="l.partner_id.name"/>
                            </td>
                            <td id="data_vat" style="text-align: center">
                                <span t-field="l.vat_number"/>
                            </td>
                            <t t-set="number_taxes" t-value="0" />
                            <t t-foreach="l.tax_lines_received_ids" t-as="tax">

                              <t t-if="number_taxes != 0">
                                <tr>
                                  <td colspan="5">
                                  </td>
                                  <td>
                                    <span t-esc="tax.name"/>
                                  </td>
                                  <td id="data_base_tax_hight" style="text-align: right">
                                    <span t-esc="formatLang(tax.amount_without_tax)"/>
                                  </td>
                                  <td id="data_type_tax_hight" style="text-align: right">
                                      <span t-esc="tax.tax_percent * 100"/>
                                  </td>
                                  <td id="data_cuote_tax_hight" style="text-align: right">
                                      <span t-esc="formatLang(tax.tax_amount)"/>
                                  </td>
                                  <td style="text-align: right">
                                    <span t-esc="formatLang(l.total)"/>
                                  </td>
                                </tr>
                              </t>

                              <t t-if="number_taxes == 0">
                                <td>
                                  <span t-esc="tax.name"/>
                                </td>
                                  <td id="data_base_first_tax" style="text-align: right">
                                      <span t-esc="formatLang(tax.amount_without_tax)"/>
                                  </td>
                                  <td id="data_type_first_tax" style="text-align: right">
                                      <span t-esc="tax.tax_percent * 100"/>
                                  </td>
                                  <td id="data_cuote_first_tax" style="text-align: right">
                                      <span t-esc="formatLang(tax.tax_amount)"/>
                                  </td>
                                  <td style="text-align: right">
                                    <span t-esc="formatLang(l.total)"/>
                                  </td>
                              </t>

                              <t t-set="number_taxes" t-value="number_taxes + 1" />
                            </t>
                        </tr>
                    </tbody>
                </table> <!-- end detail_table -->
              </div> <!-- end detail div -->

              <div class="col-xs-12" id="title_sumary_invoices">
                <h4><strong>Summary invoices received</strong></h4>
              </div>
              <div class="col-xs-12" id="div_sumary_invoices">
                <table class="table table-condensed" id="table_sumary_invoices">
                    <thead>
                      <tr>
                        <td class="text-center" style="text-align: center" id="sumary_code"><strong>Code</strong></td>
                        <td class="text-center" style="text-align: center" id="sumary_base"><strong>Base</strong></td>
                        <td class="text-center" style="text-align: center" id="sumary_cuote"><strong>Cuote</strong></td>
                        <td class="text-center" style="text-align: center" id="sumary_type"><strong>Type</strong></td>
                        <td class="text-center" style="text-align: center"><strong>Total</strong></td>
                      </tr>
                    </thead>
                    <tbody>
                        <tr t-foreach="o.received_tax_summary" t-as="s">
                            <td class="text-center" id="data_sumary_code">
                             <span t-field="s.tax_code_id.name"/>
                            </td>
                            <td class="text-center" id="data_sumary_base" style="text-align: right">
                                <span t-esc="formatLang(s.sum_base_amount) or '0'"/>
                            </td>
                            <td class="text-center" id="data_sumary_cuote" style="text-align: right">
                                <span t-esc="formatLang(s.sum_tax_amount) or '0'"/>
                            </td>
                            <td class="text-center" id="data_sumary_type" style="text-align: right">
                                <span t-esc="formatLang(s.tax_percent * 100) or '0'"/>
                            </td>
                            <td class="text-center" style="text-align: right">
                              <span t-esc="formatLang(s.sum_tax_amount + s.sum_base_amount)" />
                            </td>
                        </tr>
                        <tr id="total_sumary">
                            <td class="text-right" id="total_sumary_code">
                             <strong>Total</strong>
                            </td>
                            <td class="text-center" id="total_sumary_base" style="text-align: right">
                              <strong><span t-esc="formatLang(o.amount_without_tax_received)"/></strong>
                            </td>
                            <td class="text-center" id="total_sumary_cuote" style="text-align: right">
                              <strong><span t-esc="formatLang(o.amount_tax_received)"/></strong>
                            </td>
                            <td>
                            </td>
                            <td class="text-center" id="total_sumary_type" style="text-align: right">
                              <strong><span t-esc="formatLang(o.amount_total_received)"/></strong>
                            </td>
                        </tr>
                    </tbody>
                </table>
              </div>

        </div>
      </div> <!-- Close div page -->

    </t>
</template>

<template id="tmp_report_vat_book_invoices_received">
    <t t-call="report.html_container">
        <t t-foreach="doc_ids" t-as="doc_id">
            <t t-raw="translate_doc(doc_id, doc_model, 'company_id.partner_id.lang', 'l10n_es_vat_book.report_vat_book_invoices_received_document')"/>
        </t>
    </t>
</template>

<record id="report_vat_book_invoices_received" model="ir.actions.report.xml">
    <field name="paperformat_id" ref="l10n_es_vat_book.paperformat_lowmargin_lowfooter"></field>
</record>

</data>
</openerp>
