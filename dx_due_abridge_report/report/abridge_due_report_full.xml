<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <template id="dx_due_abridge_report.report_due_list_full" name="Resumen de liquidaciÃ³n de iva">
            <t t-call="report.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="report.external_layout">
                        <div class="page">
                            <h1 t-esc="'Informe de efectos: Cobros' if o['payment_type']== '0' else 'Informe de efectos: Pagos'"></h1>
                            <br></br>
                            <h2>Resumen</h2>
                            <t style="font-size:12px; text-align: left; border: solid 1px;  font-weight: bold" t-esc="get_filter()"></t>
                            <p t-if="not get_summary()"  style="font-weight: bold; text-align: center;"><br/><br/><br/><br/><br/>No hay ningun registro en este rango de fechas.
                              <t t-set="filtro" t-value="0"/>
                            </p>
                            <t t-if="get_summary()">
                              <t t-set="filtro" t-value="1"/>
                            <table class="table table-condensed" style="width: 100%; font-size: 12px; border-left: solid 1px; page-break-after:always;">
                                <tr style="border: solid 1px; background-color: #E0E0E0">
                                    <th style="border: solid 1px; vertical-align: middle; width: 85%;">Modo de pago</th>
                                    <th class="text-right" style="border: solid 1px; vertical-align: middle; width: 15%;">Total</th>
                                </tr>
                                <t t-set="total_summ" t-value="0"/>
                                <t t-foreach="get_summary()" t-as="r">
                                  <tr>
                                    <td style="border: solid 1px;">
                                        <span t-esc="r['payment_mode']"></span>
                                    </td>
                                    <td class="text-right" style="border: solid 1px;">
                                        <span t-esc="'{0:,.2f}'.format(r['total']).replace('.','%temp%').replace(',','.').replace('%temp%',',')"></span>
                                    </td>
                                    <t t-set="total_summ" t-value="total_summ+r['total']"/>
                                  </tr>
                                  </t>
                                  <tr>
                                    <th class="text-right" style="border: solid 1px; text-align: right">
                                      <strong>TOTAL:</strong>
                                    </th>
                                    <th class="text-right" style="border: solid 1px; text-align: right; width:10%">
                                      <t t-esc="'{0:,.2f}'.format(total_summ).replace('.','%temp%').replace(',','.').replace('%temp%',',')"></t>
                                    </th>
                                  </tr>
                                </table> 
                                </t>
                                <t t-if="filtro">
                                <t style="font-size:12px; text-align: left; border: solid 1px;  font-weight: bold" t-esc="get_filter()"></t>
                              </t>
                            <t t-foreach="get_dates()" t-as="d">
                                <t t-set="total_var" t-value="0"/>
                                <table class="table table-condensed" style="width: 100%; font-size: 10px; border-left: solid 1px; page-break-inside: avoid;">
                                    <thead>
                                        <tr style="border: solid 1px; background-color: #E0E0E0">
                                            <td colspan="1" style="font-weight: bold; border-right: solid 1px;" t-esc="d['format_date']"></td>
                                        </tr>
                                    </thead>
                                    <tr t-foreach="get_data(d['date'])" t-as="data">
                                      <t t-set="cabecera" t-value="1"/>
                                        <tr t-foreach="data" t-as="l">
                                            <t t-if="cabecera">
                                                    <th colspan="7" style="border: solid 1px; vertical-align: middle; background-color: #E0E0E0;" t-esc="l['payment_mode']"></th>
                                                <tr style="border: solid 1px;">
                                                  <th style="border: solid 1px; vertical-align: middle;">Factura</th>
                                                  <th style="border: solid 1px; vertical-align: middle;">Vencimiento</th>
                                                  <th style="border: solid 1px; vertical-align: middle;">Referencia</th>
                                                  <th style="border: solid 1px; vertical-align: middle;">Empresa</th>
                                                  <th style="border: solid 1px; vertical-align: middle;">Modo de pago</th>
                                                  <th style="border: solid 1px; vertical-align: middle;">Cuenta Bancaria</th>
                                                  <th class="text-right" style="border: solid 1px; vertical-align: middle;">Importe</th>
                                                </tr>
                                                <t t-set="cabecera" t-value="0"/>
                                            </t>
                                            <td style="border: solid 1px;">
                                                <span t-esc="l['invoice']"></span>
                                            </td>
                                            <td style="border: solid 1px;">
                                                <span t-esc="l['maturity']"></span>
                                            </td>
                                            <td style="border: solid 1px;">
                                                <span t-esc="l['ref']"></span>
                                            </td>
                                            <td style="border: solid 1px;">
                                                <span t-esc="l['partner_id']"></span>
                                            </td>
                                            <td style="border: solid 1px;">
                                                <span t-esc="l['payment_mode']"></span>
                                            </td>
                                            <td style="border: solid 1px;">
                                                <span t-esc="l['account']"></span>
                                            </td>
                                            <td class="text-right" style="border: solid 1px;">
                                              <span t-esc="'{0:,.2f}'.format(l['total']).replace('.','%temp%').replace(',','.').replace('%temp%',',')"></span>
                                            </td>
                                            <t t-set="total_var" t-value="total_var+l['total']"/>
                                        </tr>
                                    </tr>
                                    <tr>
                                        <th colspan="6" class="text-right" style="border: solid 1px; text-align: right">
                                            <strong>TOTAL:</strong>
                                        </th>
                                        <th class="text-right" style="border: solid 1px; text-align: right; width:10%">
                                            <t t-esc="'{0:,.2f}'.format(total_var).replace('.','%temp%').replace(',','.').replace('%temp%',',')"></t>
                                        </th>
                                    </tr>
                                </table>
                            </t>
                        </div>
                    </t>
                </t>
            </t>
        </template>
        <report id="report_due_list_full_id" string="Due list" model="account.move.line" report_type="qweb-pdf" name="dx_due_abridge_report.report_due_list_full" file="dx_due_abridge_report.report_due_list_full" menu="False"/>
        <record id="dx_due_abridge_report.report_due_list_full_id" model="ir.actions.report.xml">
            <field name="paperformat_id" ref="dx_due_abridge_report.paperformat_due_abridge_full"/>
        </record>
    </data>
</openerp>